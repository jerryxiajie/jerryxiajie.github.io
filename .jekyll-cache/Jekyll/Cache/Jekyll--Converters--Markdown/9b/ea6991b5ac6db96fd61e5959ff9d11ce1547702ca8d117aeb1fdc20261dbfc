I"„<ul id="markdown-toc">
  <li><a href="#linux-c-ä¹‹-getopt-å‡½æ•°" id="markdown-toc-linux-c-ä¹‹-getopt-å‡½æ•°">Linux C ä¹‹ getopt() å‡½æ•°</a>    <ul>
      <li><a href="#1-è§£å†³çš„é—®é¢˜" id="markdown-toc-1-è§£å†³çš„é—®é¢˜">1. è§£å†³çš„é—®é¢˜</a></li>
      <li><a href="#2å‡½æ•°åŸå‹" id="markdown-toc-2å‡½æ•°åŸå‹">2.å‡½æ•°åŸå‹</a></li>
      <li><a href="#3ä»-main-å‡½æ•°ä¼ å…¥å‚æ•°" id="markdown-toc-3ä»-main-å‡½æ•°ä¼ å…¥å‚æ•°">3.ä» main å‡½æ•°ä¼ å…¥å‚æ•°</a></li>
      <li><a href="#4å¤„ç†ä¼ å…¥çš„å‚æ•°" id="markdown-toc-4å¤„ç†ä¼ å…¥çš„å‚æ•°">4.å¤„ç†ä¼ å…¥çš„å‚æ•°</a></li>
    </ul>
  </li>
</ul>

<p>ç¬¬ä¸€ç¯‡åšå®¢ï¼Œgithub + jekyll</p>

<p>ä»‹ç» Linux C getopt() çš„ä½¿ç”¨</p>

<h2 id="linux-c-ä¹‹-getopt-å‡½æ•°">Linux C ä¹‹ getopt() å‡½æ•°</h2>

<h4 id="1-è§£å†³çš„é—®é¢˜">1. è§£å†³çš„é—®é¢˜</h4>

<p>å‘½ä»¤è¡Œå‚æ•°çš„è§£æã€‚</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./pi_desktop -f /root/pi_desktop/demo.bin -v 1 -r

</code></pre></div></div>

<p>ä¾‹å¦‚ä¸Šé¢çš„å‘½ä»¤ä¸­çš„:  <strong>-f /root/pi_desktop/demo.bin -v 1 -r</strong></p>

<p>getopt() å‡½æ•°å°±æ˜¯ç”¨æ¥è§£æå‘½ä»¤è¡Œå‚æ•°çš„ï¼›</p>

<p>è°ƒç”¨çš„ä¸€èˆ¬å½¢å¼å¦‚ä¸‹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
while((c = getopt(argc, argv, "xy:z::")) != -1){
      switch(c){
      case 'x':   ... ...
      case 'y':   ... ...
      case 'z':   ... ...
      ... ....
      }
}
... ....

</code></pre></div></div>

<h4 id="2å‡½æ•°åŸå‹">2.å‡½æ•°åŸå‹</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
#include &lt;unistd.h&gt;
int getopt(int argc, char * const argv[], const char *optstring);
extern char *optarg; 
extern int optind,  // åˆå§‹åŒ–å€¼ä¸º1ï¼Œä¸‹ä¸€æ¬¡è°ƒç”¨getoptæ—¶ï¼Œä»optindå­˜å‚¨çš„ä½ç½®é‡æ–°å¼€å§‹æ£€æŸ¥é€‰é¡¹ã€‚ 
extern int opterr,  //åˆå§‹åŒ–å€¼ä¸º1ï¼Œå½“opterr=0æ—¶ï¼Œgetoptä¸å‘stderrè¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚
extern int optopt;  //å½“å‘½ä»¤è¡Œé€‰é¡¹å­—ç¬¦ä¸åŒ…æ‹¬åœ¨optstringä¸­æˆ–è€…é€‰é¡¹ç¼ºå°‘å¿…è¦çš„å‚æ•°æ—¶,è¯¥é€‰é¡¹å­˜å‚¨åœ¨optoptä¸­ï¼Œ getoptè¿”å›'ï¼Ÿâ€™ã€‚

</code></pre></div></div>

<h4 id="3ä»-main-å‡½æ•°ä¼ å…¥å‚æ•°">3.ä» main å‡½æ•°ä¼ å…¥å‚æ•°</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int main(int argc,char * argv[])
{
    ...
}

</code></pre></div></div>

<p><strong>argc</strong>ï¼šè¡¨ç¤ºäº†å‘½ä»¤è¡Œä¸­å‚æ•°çš„ä¸ªæ•°(æ³¨æ„ï¼šæ–‡ä»¶åæœ¬èº«ä¹Ÿç®—ä¸€ä¸ªå‚æ•°)ï¼Œargcçš„å€¼æ˜¯åœ¨è¾“å…¥å‘½ä»¤è¡Œæ—¶ç”±ç³»ç»ŸæŒ‰å®é™…å‚æ•°çš„ä¸ªæ•°è‡ªåŠ¨èµ‹äºˆçš„ã€‚</p>

<p><strong>argv</strong>ï¼šæ˜¯å­—ç¬¦ä¸²æŒ‡é’ˆæ•°ç»„ï¼Œå…¶å„å…ƒç´ å€¼ä¸ºå‘½ä»¤è¡Œä¸­å„å­—ç¬¦ä¸²(å‚æ•°å‡æŒ‰å­—ç¬¦ä¸²å¤„ç†)çš„é¦–åœ°å€ã€‚ æŒ‡é’ˆæ•°ç»„çš„é•¿åº¦å³ä¸ºå‚æ•°ä¸ªæ•°ã€‚æ•°ç»„å…ƒç´ åˆå€¼ç”±ç³»ç»Ÿè‡ªåŠ¨èµ‹äºˆã€‚</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
#include &lt;stdio.h&gt;

int main (int argc,char * argv)
{
    printf("argc = %d \n", argc);
    printf("argv = %s \n", argv);
    
    return 0;
}

</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
gcc test.c -o test

</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./test

</code></pre></div></div>

<p>è¾“å‡ºï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
argc = 1
argv = ./test

</code></pre></div></div>

<h4 id="4å¤„ç†ä¼ å…¥çš„å‚æ•°">4.å¤„ç†ä¼ å…¥çš„å‚æ•°</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
int getopt(int argc, char * const argv[], const char *optstring);

</code></pre></div></div>

<p>å‰ä¸¤ä¸ªå‚æ•°å°±æ˜¯ main å‡½æ•°ä¼ å…¥çš„å‚æ•°ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯é€‰é¡¹å­—ç¬¦ä¸²ï¼Œä»–è§„å®šäº†åé¢å¯ä»¥è·Ÿçš„å‚æ•°ä»¥åŠå‚æ•°åé¢æ˜¯å¦å¯ä»¥å†æ¥å‚æ•°ã€‚è¿™ä¸ªé€‰é¡¹å­—ç¬¦ä¸²æœ‰ç‰¹å®šçš„ä¹¦å†™è§„åˆ™,å‚æ•°åé¢å¸¦æœ‰å†’å·çš„å°±è¡¨ç¤ºè¿™ä¸ªå‚æ•°åé¢è¿˜éœ€è¦å†è·Ÿå‚æ•°ã€‚æ²¡æœ‰å†’å·çš„å°±ä¸éœ€è¦ã€‚</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;
#include &lt;getopt.h&gt;

int main (int argc,char *argv[])
{
        int ch;
        while((ch = getopt(argc,argv,"f:F:v:V:rR")) != -1 )
        {
                switch(ch)
                {
                        case 'f':
                                printf("Param f! \n");
                                printf("Follow param = %s",optarg);
                                break;
                        case 'F':
                                printf("Param F! \n");
                                printf("Follow param = %s",optarg);
                                break;
                        case 'v':
                                printf("Param v! \n");
                                printf("Follow param = %s",optarg);
                                break;
                        case 'V':
                                printf("Param V \n");
                                printf("Follow param = %s",optarg);
                                break;
                        case 'r':
                                printf("Param r! \n");
                                break;
                        case 'R':
                                printf("Param R! \n");
                                break;
                        default:
                                printf("ERROR! \n");
                                break;
                }
        }
        return 0;
}

</code></pre></div></div>

<p>å¸¦å‚æ•°çš„é€‰é¡¹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
jerry@ubuntu:~/Desktop$ ./getTest -v 4
Param v! 
Folow param = 4

</code></pre></div></div>

<p>ä¸å¸¦å‚æ•°çš„é€‰é¡¹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
jerry@ubuntu:~/Desktop$ ./getTest -r
Param r! 

</code></pre></div></div>
:ET